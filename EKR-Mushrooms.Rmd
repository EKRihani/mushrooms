---
title: "Mushrooms Dataset Analysis"
author: "E.K. RIHANI"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  pdf_document:
    number_sections: true   # Add section numbering
    toc: true
    toc_depth: 3

header-includes:
indent: true   # Indent paragraphs
bibliography: packages.bib #, references.bib
references:
  - id: mushroom2
    title: "Mushroom data creation, curation, and simulation to support classification tasks"
    author: D.Wagner, D.Heider, G.Hattab
    url: https://doi.org/10.1038/s41598-021-87602-3
    DOI: 10.1038/s41598-021-87602-3
    publisher: Scientific Reports
    type: article-journal
    issued:
      year: 2021
  - id: mushroom1
    title: "Concept Acquisition Through Representational Adjustment"
    author: D.Wagner, D.Heider, G.Hattab
    url: 
    DOI: 
    publisher: University of California
    type: article-journal
    issued:
      year: 1987

csl: https://www.zotero.org/styles/vancouver-superscript
#- \usepackage{indentfirst} # Indent first line of each paragraph
---

```{r setup, include = FALSE}
load("EKR-mushrooms.RData")
if(!require(ggpubr)) install.packages("ggpubr", repos = "http://cran.us.r-project.org")
if(!require(rmarkdown)) install.packages("rmarkdown", repos = "http://cran.us.r-project.org")
if(!require(knitr)) install.packages("knitr", repos = "http://cran.us.r-project.org")
if(!require(tidyverse)) install.packages("tidyverse", repos = "http://cran.us.r-project.org")
#library(ggplot2)
library(ggpubr)   # Combine plots (ggarrange)
library(rmarkdown)
library(knitr)
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
knitr::write_bib(c("tidyverse", "rmarkdown", "knitr", "ggpubr"), "packages.bib")
#knitr::write_bib(c("tidyverse", "caret", "data.table", "reshape2", "ggplot2", "ggrepel", "recommenderlab", "stringr", "ggpubr", "rmarkdown", "knitr"), "packages.bib")
```
\newpage
\section{Overview}
\subsection{Goal of the study}
\paragraph*{}
Mushroom identification

\subsection{The dataset}
\paragraph*{}
The Secondary Mushroom Identification Dataset was submitted by Dennis Wagner in 2021, and is inspired by the Mushroom Dataset created by Jeff Schlimmer in 1987. Both datasets aim to create a fictionnal collection of mushrooms, built by gathering characteristics about a selected number of mushroom species, then randomizing each individual mushroom quantitative variables along the species typical characteristics (i.e. cap diameter, stem  height, stem width).  
\paragraph*{}

(a) Mushroom species drawn from source book: Patrick Hardin.Mushrooms & Toadstools. Zondervan, 1999
\paragraph*{}
This dataset contains the data from n = `r summary_number` mushrooms (rows). Each mushroom has `r nrow(structure_dataset)` attributes (columns) :
\paragraph*{}
* *Class* : edible (e) or poisonous (p)
* *Cap diameter* : in centimeters
* *Cap shape* : bell (b), conical (c), convex (x), flat (f), sunken (s), spherical (p) or other (o)
* *Cap surface* : fibrous (i), grooves (g), scaly (y), smooth (s), shiny (h), leathery (l), silky (k), sticky (t), wrinkled (w) or fleshy (e)
* *Cap color* : brown (n), buff (b), gray (g), green (r), pink (p), purple (u), red (e), white (w), yellow (y), blue (l), orange (o) or black (k)
* *Does bruise or bleed* : true (t) or false (f)
* *Gill attachment* : adnate (a), adnexed (x), decurrent (d), free (e), sinuate (s), pores (p), none (f), unknown (?)
* *Gill spacing* : close (c), distant (d), none (f)
* *Gill color* : brown (n), buff (b), gray (g), green (r), pink (p), purple (u), red (e), white (w), yellow (y), blue (l), orange (o), black (k) or none (f)
* *Stem height* : in centimeters
* *Stem width* : in millimeters
* *Stem root* : bulbous (b), swollen (s), club (c), cup (u), equal (e), rhizomorphs (z), rooted (r) or none (f)
* *Stem surface* : fibrous (i), grooves (g), scaly (y), smooth (s), shiny (h), leathery (l), silky (k), sticky (t), wrinkled (w), fleshy (e) or none (f)
* *Stem color* : brown (n), buff (b), gray (g), green (r), pink (p), purple (u), red (e), white (w), yellow (y), blue (l), orange (o), black (k) or none (f)
* *Veil type* : partial (p) or universal (u)
* *Veil color* : brown (n), buff (b), gray (g), green (r), pink (p), purple (u), red (e), white (w), yellow (y), blue (l), orange (o), black (k) or none (f)
* *Has ring* : true (t) or false (f)
* *Ring type* : cobwebby (c), evanescent (e), flaring (r), grooved (g), large (l), pendant (p), sheathing (s), zone (z), scaly (y), movable (m), none (f) or unknown (?)
* *Spore print color* : brown (n), buff (b), gray (g), green (r), pink (p), purple (u), red (e), white (w), yellow (y), blue (l), orange (o), black (k) or none (f)
* *Habitat* : grasses (g), leaves"(l), meadows (m), paths (p), heaths (h), urban (u), waste (w) or woods (d)
* *Season* : spring (s), summer (u), autumn (a) or winter (w)

\newpage
\section{Methods and Analysis}
\subsection{Computer and R configuration}
\paragraph*{}
The code, benchmarks and report were run on the following computer configuration :

* CPU : AMD Ryzen 5 5600G
* RAM : 2x16 GB DDR4-3200
* SSD : Crucial P5 M2 NVMe
* OS : Xubuntu Linux
* R : version 3.6.3
* Packages : tidyverse[@R-tidyverse] (v1.3.1), ggrepel[@R-ggrepel] (v0.9.1), ggpubr[@R-ggpubr] (v0.4.0), rmarkdown[@R-rmarkdown] (v2.11), knitr[@R-knitr] (v1.34).

\paragraph*{}
The code was also tested on a Windows 7 x64 SP1 computer with 16 GB RAM, and R 4.1.0. It was not tested on any Mac OS system.
\subsection{Data preparation and cleaning}
\paragraph*{}
The dataset is directly downloaded from the UCI database in zip format and unzipped. The archive contains four files :

* *primary_data.csv* : the csv file with all data used for creating the base. One line for each of the 173 species.
* *primary_data_meta.txt* : metadata for the primary dataset.
* *secondary_data.csv* : the final dataset, made of all  `r summary_number` specimen.
* *secondary_data_meta.txt* : metadata for the secondary dataset.

\paragraph*{}
The file of interest (*secondary_data.csv*) is extracted using the *read.csv* function.
\paragraph*{}
The initial and final structures of the dataset are as following :
```{r out.width = "90%", echo = FALSE}
kable(structure_dataset, caption = "Dataset structure")
```
The import automatically converted all character variables to factors. The only structural modification was to modify some of the 2-level factors into logical variables.
\paragraph*{}
The primary and secondary *data_meta* files include all information to translate the one-letter variable codes into comprehensible words. However, one variable code is missing : the *stem.root = f* value isn't explained. Since most *f* values for the other categorical stem variables (*stem.surface*, *stem.color*) mean the mushroom has no stem and given the fact that all stem.root = f values are always associated with *stem.surface = f*, *stem.color = f*, *stem.height = 0* and *stem.width = 0*, one can safely assume that *stem.root = f* isimply means there is no stem.
```{r out.width = "90%", echo = FALSE}
kable(uniques_missing_f, caption = "Unique values for stem.root = 'f'")
```
\paragraph*{}
We can then get basic information about our mushroom population, such as dimensional distributions.  
```{r, echo = FALSE, fig.cap = "Mushroom cap diameter, stem height and stem width distribution"}
plot(ggarrange(
   ncol = 3,
   study_distrib_cap.diameter + ggtitle("") + ylab("") + scale_y_continuous(labels = NULL),
   study_distrib_stem.height + ggtitle("") + ylab("") + scale_y_continuous(labels = NULL),
   study_distrib_stem.width + ggtitle("") + ylab("") + scale_y_continuous(labels = NULL)
   )
)
```  
\paragraph*{}
All dimensional distributions seem to roughly follow a bell curbe, with a long tail towards the higher values.
\paragraph*{}
A logarithmic transformation can help us see the shape of this tail.  
```{r, echo = FALSE, fig.cap = "Mushroom cap diameter, stem height and stem width distribution"}
plot(ggarrange(
   ncol = 3,
   study_distrib_cap.diameter + ggtitle("") + ylab("") + scale_y_log10(labels = NULL),
   study_distrib_stem.height + ggtitle("") + ylab("") + scale_y_log10(labels = NULL),
   study_distrib_stem.width + ggtitle("") + ylab("") + scale_y_log10(labels = NULL)
   )
)
```  
\paragraph*{}
The cap diameter distribution looks like a bell curve with a long right tail but actually is bimodal, with a main mode toward 5 cm, and a much smaller secondary mode toward 50 cm. This size can look quite surprising, but some species such as *Polyporus squamosus* (dryad's saddle) can be very large with some specimens that can weight up to 5 kg.
\paragraph*{}
The stem height distribution also looks like a bell curve with a long right tail, a main mode around 5 cm, and a secondary mode at 0 cm. Again, this can look surprising, but some mushrooms have no stem, which could explain this height value.
\paragraph*{}
The stem width distribution looks like a bell curve with a long right tail, and a peak around 12 mm. In all three distributions, the right tail can probably be explained by the impossibility to have negative dimensional values.

\paragraph*{}
*Section that explains the process and techniques used, including data cleaning, data exploration and visualization, insights gained, and your modeling approach*

\newpage
\section{Results}

*Section that presents the modeling results and discusses the model performance.*

\newpage
\section{Conclusion}

*Section that gives a brief summary of the report, its limitations and future work*

\newpage
\section{References}
